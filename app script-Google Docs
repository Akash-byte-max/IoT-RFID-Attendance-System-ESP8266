var ss = SpreadsheetApp.openById('1vYjps3xhqM3sRNOngCVP2_K1x3oHZnegFa_1Odzc_dY');
var sheet = ss.getSheetByName('Sheet1');
var timezone = "Asia/Kolkata";

function doGet(e) {
  Logger.log(JSON.stringify(e));

  if (!e.parameter.name || !e.parameter.usn) {
    return ContentService.createTextOutput("Missing Parameters");
  }

  var Curr_Date = new Date();
  var Curr_Time = Utilities.formatDate(Curr_Date, timezone, 'HH:mm:ss');

  var name = stripQuotes(e.parameter.name);
  var usn = stripQuotes(e.parameter.usn);

  var nextRow = sheet.getLastRow() + 1;

  sheet.getRange("A" + nextRow).setValue(Curr_Date);
  sheet.getRange("B" + nextRow).setValue(Curr_Time);
  sheet.getRange("C" + nextRow).setValue(name);
  sheet.getRange("D" + nextRow).setValue(usn);

  return ContentService.createTextOutput("Data Stored Successfully");
}

function stripQuotes(value) {
  return value.toString().replace(/^["']|['"]$/g, "");
}
